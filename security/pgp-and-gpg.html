<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>PGP 与 GPG - 程序员入门指南</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../favicon.svg">
                        <link rel="shortcut icon" href="../favicon.png">
                <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
                <link rel="stylesheet" href="../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
                <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../preface.html">序言</a></li><li class="chapter-item expanded "><a href="../know-your-computer/index.html"><strong aria-hidden="true">1.</strong> 认识自己的计算机</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../know-your-computer/what-are-computers.html"><strong aria-hidden="true">1.1.</strong> 什么是计算机</a></li><li class="chapter-item expanded "><a href="../know-your-computer/buying-a-computer.html"><strong aria-hidden="true">1.2.</strong> 购买一台计算机</a></li><li class="chapter-item expanded "><a href="../know-your-computer/use-electronic-products.html"><strong aria-hidden="true">1.3.</strong> 使用电子产品</a></li><li class="chapter-item expanded "><a href="../know-your-computer/interface-and-protocol.html"><strong aria-hidden="true">1.4.</strong> 常见的接口、协议</a></li></ol></li><li class="chapter-item expanded "><a href="../use-your-computer/index.html"><strong aria-hidden="true">2.</strong> 使用自己的计算机</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../use-your-computer/files-and-directories.html"><strong aria-hidden="true">2.1.</strong> 目录、文件、文件系统</a></li><li class="chapter-item expanded "><a href="../use-your-computer/file-format.html"><strong aria-hidden="true">2.2.</strong> 文件格式</a></li><li class="chapter-item expanded "><a href="../use-your-computer/organize-your-files.html"><strong aria-hidden="true">2.3.</strong> 整理自己的文件</a></li><li class="chapter-item expanded "><a href="../use-your-computer/interact-with-pc.html"><strong aria-hidden="true">2.4.</strong> 与计算机交互</a></li><li class="chapter-item expanded "><a href="../use-your-computer/font-and-font-rendering.html"><strong aria-hidden="true">2.5.</strong> 字体与字体渲染</a></li><li class="chapter-item expanded "><a href="../know-your-computer/io-devices.html"><strong aria-hidden="true">2.6.</strong> 输入输出设备</a></li><li class="chapter-item expanded "><a href="../use-your-computer/markup-lang-and-rich-text.html"><strong aria-hidden="true">2.7.</strong> 标记语言和富文本</a></li><li class="chapter-item expanded "><a href="../use-your-computer/network-and-internet.html"><strong aria-hidden="true">2.8.</strong> 网络和互联网</a></li><li class="chapter-item expanded "><a href="../use-your-computer/browsing-internet.html"><strong aria-hidden="true">2.9.</strong> 如何浏览互联网</a></li><li class="chapter-item expanded "><a href="../use-your-computer/what-can-internet-do.html"><strong aria-hidden="true">2.10.</strong> 互联网能做什么</a></li><li class="chapter-item expanded "><a href="../use-your-computer/safe-internet-connection.html"><strong aria-hidden="true">2.11.</strong> 建立安全的网络连接</a></li><li class="chapter-item expanded "><a href="../use-your-computer/acquire-and-install-apps.html"><strong aria-hidden="true">2.12.</strong> 获取、安装应用程序</a></li><li class="chapter-item expanded "><a href="../use-your-computer/work-efficiently.html"><strong aria-hidden="true">2.13.</strong> 高效地使用计算机</a></li></ol></li><li class="chapter-item expanded "><a href="../web-surfing/index.html"><strong aria-hidden="true">3.</strong> 网上冲浪</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../web-surfing/learn-english.html"><strong aria-hidden="true">3.1.</strong> 掌握一门外语——英语</a></li><li class="chapter-item expanded "><a href="../web-surfing/obtain-information.html"><strong aria-hidden="true">3.2.</strong> 信息获取与搜索技巧</a></li><li class="chapter-item expanded "><a href="../web-surfing/search-for-help.html"><strong aria-hidden="true">3.3.</strong> 利用网络解决问题</a></li><li class="chapter-item expanded "><a href="../web-surfing/notes-taking.html"><strong aria-hidden="true">3.4.</strong> 做笔记</a></li><li class="chapter-item expanded "><a href="../web-surfing/markdown-tips.html"><strong aria-hidden="true">3.5.</strong> Markdown 技巧</a></li><li class="chapter-item expanded "><a href="../web-surfing/web-accessibility-intro.html"><strong aria-hidden="true">3.6.</strong> Web 无障碍</a></li><li class="chapter-item expanded "><a href="../web-surfing/intro-to-mastodon.html"><strong aria-hidden="true">3.7.</strong> Mastodon 介绍</a></li><li class="chapter-item expanded "><a href="../web-surfing/better-web-experience.html"><strong aria-hidden="true">3.8.</strong> 更好的浏览体验</a></li></ol></li><li class="chapter-item expanded "><a href="../begin-programming/index.html"><strong aria-hidden="true">4.</strong> 开始编程</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../begin-programming/what-is-programming.html"><strong aria-hidden="true">4.1.</strong> 什么是编程</a></li><li class="chapter-item expanded "><a href="../begin-programming/cli/cli-and-shell.html"><strong aria-hidden="true">4.2.</strong> 命令行与 Shell 程序</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../begin-programming/cli/common-commands.html"><strong aria-hidden="true">4.2.1.</strong> 一些常用 Shell 命令</a></li><li class="chapter-item expanded "><a href="../begin-programming/cli/common-cli-tools.html"><strong aria-hidden="true">4.2.2.</strong> 一些常用命令行工具</a></li></ol></li><li class="chapter-item expanded "><a href="../begin-programming/ds-algo-intro.html"><strong aria-hidden="true">4.3.</strong> 数据结构与算法入门</a></li><li class="chapter-item expanded "><a href="../begin-programming/read-cpp.html"><strong aria-hidden="true">4.4.</strong> 看懂 C/C++ 代码</a></li><li class="chapter-item expanded "><a href="../begin-programming/first-cpp-program.html"><strong aria-hidden="true">4.5.</strong> 编译运行第一个 C/C++ 程序</a></li><li class="chapter-item expanded "><a href="../begin-programming/software-build.html"><strong aria-hidden="true">4.6.</strong> 什么是构建</a></li><li class="chapter-item expanded "><a href="../begin-programming/programming-paradigm.html"><strong aria-hidden="true">4.7.</strong> 编程范式</a></li><li class="chapter-item expanded "><a href="../begin-programming/uml/intro-to-uml.html"><strong aria-hidden="true">4.8.</strong> UML：统一建模语言</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../begin-programming/uml/class-diagram.html"><strong aria-hidden="true">4.8.1.</strong> UML 类图</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.8.2.</strong> 用例模型 Use Case Model</div></li></ol></li><li class="chapter-item expanded "><a href="../begin-programming/setup-develop-environment.html"><strong aria-hidden="true">4.9.</strong> 搭建开发环境</a></li><li class="chapter-item expanded "><a href="../begin-programming/vm/index.html"><strong aria-hidden="true">4.10.</strong> 使用虚拟机</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../begin-programming/vm/try-ubuntu-on-windows.html"><strong aria-hidden="true">4.10.1.</strong> 在 Windows 上的虚拟机中安装 Ubuntu</a></li></ol></li><li class="chapter-item expanded "><a href="../begin-programming/coding-practice.html"><strong aria-hidden="true">4.11.</strong> 代码规范</a></li></ol></li><li class="chapter-item expanded "><a href="../code-sharing/index.html"><strong aria-hidden="true">5.</strong> 代码的分享、管理与协作</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../code-sharing/where-it-all-began.html"><strong aria-hidden="true">5.1.</strong> 从代码分享说起</a></li><li class="chapter-item expanded "><a href="../code-sharing/code-hosting-platform-and-vcs.html"><strong aria-hidden="true">5.2.</strong> 代码托管平台与版本控制系统</a></li><li class="chapter-item expanded "><a href="../code-sharing/try-code-hosting-and-vcs.html"><strong aria-hidden="true">5.3.</strong> 代码托管与版本控制的实际使用</a></li><li class="chapter-item expanded "><a href="../code-sharing/about-github.html"><strong aria-hidden="true">5.4.</strong> 关于 GitHub</a></li><li class="chapter-item expanded "><a href="../code-sharing/page-hosting.html"><strong aria-hidden="true">5.5.</strong> 静态页托管</a></li><li class="chapter-item expanded "><a href="../code-sharing/continuous-intergration.html"><strong aria-hidden="true">5.6.</strong> 持续集成（CI）</a></li></ol></li><li class="chapter-item expanded "><a href="../cpp/index.html"><strong aria-hidden="true">6.</strong> 编程语言：C++</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cpp/pointers-and-references.html"><strong aria-hidden="true">6.1.</strong> 指针和引用</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.2.</strong> 变量作用域、生命期</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.3.</strong> 动态内存分配</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.4.</strong> 类和对象</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.5.</strong> 浅拷贝、深拷贝</div></li><li class="chapter-item expanded "><a href="../cpp/macro-and-preprocess.html"><strong aria-hidden="true">6.6.</strong> 宏定义、预处理指令</a></li><li class="chapter-item expanded "><a href="../cpp/undefined-behaviors.html"><strong aria-hidden="true">6.7.</strong> 未定义行为</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.8.</strong> 异常处理</div></li><li class="chapter-item expanded "><a href="../cpp/cpp-coding-practice.html"><strong aria-hidden="true">6.9.</strong> C/C++ 代码规范</a></li><li class="chapter-item expanded "><a href="../cpp/cpp-best-practice.html"><strong aria-hidden="true">6.10.</strong> C++ 编程最佳实践</a></li><li class="chapter-item expanded "><a href="../cpp/project/index.html"><strong aria-hidden="true">6.11.</strong> C++ 工程入门</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cpp/project/multi-files-programming.html"><strong aria-hidden="true">6.11.1.</strong> C/C++ 多文件编程</a></li><li class="chapter-item expanded "><a href="../cpp/project/compile-and-link.html"><strong aria-hidden="true">6.11.2.</strong> 编译、链接</a></li><li class="chapter-item expanded "><a href="../cpp/project/cmake-intro.html"><strong aria-hidden="true">6.11.3.</strong> CMake 入门</a></li></ol></li><li class="chapter-item expanded "><a href="../cpp/modern/index.html"><strong aria-hidden="true">6.12.</strong> 现代 C++</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cpp/modern/cpp-auto.html"><strong aria-hidden="true">6.12.1.</strong> auto 关键字</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.12.2.</strong> C++ STL</div></li><li class="chapter-item expanded "><a href="../cpp/modern/cpp-enum.html"><strong aria-hidden="true">6.12.3.</strong> 枚举类型与 enum class</a></li><li class="chapter-item expanded "><a href="../cpp/modern/lambda-expression.html"><strong aria-hidden="true">6.12.4.</strong> C++ Lambda 表达式</a></li><li class="chapter-item expanded "><a href="../cpp/modern/wrap-algorithm-with-class.html"><strong aria-hidden="true">6.12.5.</strong> 用类包装算法</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.12.6.</strong> C++ 智能指针</div></li><li class="chapter-item expanded "><a href="../cpp/modern/cpp-random.html"><strong aria-hidden="true">6.12.7.</strong> C++ random 库</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.12.8.</strong> C++ thread 库</div></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../anecdotes/index.html"><strong aria-hidden="true">7.</strong> 计算机人漫谈</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../anecdotes/hacker-how-to.html"><strong aria-hidden="true">7.1.</strong> How To Become A Hacker</a></li><li class="chapter-item expanded "><a href="../anecdotes/college-life.html"><strong aria-hidden="true">7.2.</strong> 大学生活指北</a></li></ol></li><li class="chapter-item expanded "><a href="../security/index.html"><strong aria-hidden="true">8.</strong> 计算机安全漫谈</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">8.1.</strong> TLS 与 HTTPS</div></li><li class="chapter-item expanded "><a href="../security/pgp-and-gpg.html" class="active"><strong aria-hidden="true">8.2.</strong> PGP 与 GPG</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.3.</strong> 木马与病毒</div></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">程序员入门指南</h1>

                    <div class="right-buttons">
                                                <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        <a href="https://github.com/tsagaanbar/Newly-Programmer-ABC" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                                                                        <a href="https://github.com/tsagaanbar/Newly-Programmer-ABC/edit/main/src/security/pgp-and-gpg.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>
                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="pgp-与-gpg"><a class="header" href="#pgp-与-gpg">PGP 与 GPG</a></h1>
<p>PGP（aka Pretty Good Privacy）是一套用于加密和认证的工具，由菲尔·齐默曼（Phil Zimmermann）开发。PGP 本身是商业软件，但菲尔·齐默曼于1997年与 IETF 制定了 OpenPGP 标准 <a href="https://tools.ietf.org/html/rfc2440">RFC2440</a>（最新版本为 <a href="https://tools.ietf.org/html/rfc4880">RFC4880</a>）。</p>
<blockquote>
<p>1991年，菲尔·齐默曼写了第一个个人可以用的高强度加密软件 PGP，PGP 使用的密钥长度大于128位，远远超过了美国政府的管制规定。之后他把源代码放到互联网上让人们随便下载。当美国之外也有人下载的时候，这件事就惊动了美国政府，美国政府开始对他进行调查。齐默曼决定利用美国宪法第一修正案来保护 PGP 的自由发行，他通过 MIT 出版社出版了一本书，书的内容就是 PGP 的全部源代码，这样，PGP 的源代码就成为了受美国宪法第一修正案保护的言论自由。人们开始通过这种手段对抗管制。最终，在新世纪到来之后，这类案件分别在第六巡回上诉法庭和第九巡回上诉法庭得到了同样的判决：软件源代码是言论自由，受宪法第一修正案的保护。自此，美国政府再也不能试图限制软件源代码流通了</p>
</blockquote>
<p>自由软件基金会编写了他们的 OpenPGP 自由软件实现 GPG（GNU Privacy Guard, aka GnuPG），在事实上成为了 OpenPGP 系列软件的标准。</p>
<h2 id="gnupg-的基本使用"><a class="header" href="#gnupg-的基本使用">GnuPG 的基本使用</a></h2>
<h3 id="安装-gpg"><a class="header" href="#安装-gpg">安装 GPG</a></h3>
<p>对于 Linux 用户，可以通过包管理器安装，一般名为 <code>gnupg</code>。</p>
<p>对于 macOS 用户，可以安装 GPGTool。（笔者对 macOS 不甚熟悉，需要补充和修正）</p>
<p>对于 Windows 用户，可以安装 <a href="https://www.gpg4win.org/">GPG4Win</a>。</p>
<h3 id="使用-gui-工具"><a class="header" href="#使用-gui-工具">使用 GUI 工具</a></h3>
<p>本节讲述如何使用 GPG 的 GUI 前端 Kleopatra。</p>
<p>Kleopatra 在 Windows 上作为 GPG4Win 的一部分被安装，在 Linux 上需自行从包管理器安装。</p>
<p>以下以英文版本为用例进行讲解，中文版本应很容易对应。</p>
<h4 id="生成密钥"><a class="header" href="#生成密钥">生成密钥</a></h4>
<p>首先，点击左上角的 <kbd>File</kbd>，随后在菜单中点击 <kbd>New Key Pair</kbd>，然后选择第一项“Create a personal OpenPGP key pair”，输入你选择的名字（一般建议使用 Nick Name 而不是真实姓名）和邮箱，如果需要设置可选（但建议）的密码的话，勾选“Protect the genterated key with a passphrase”。</p>
<p>如果需要更高级的配置，点击右下角的“Advanced Settings...”，笔者推荐将“Key Material”一栏中的“3,072 bits”改为“4,096 bits”以提高安全性。</p>
<p>点击右下角的 <kbd>Create</kbd>，随后输入两遍你想设置的密码（如未勾选设置密码则无此步），然后点击 <kbd>Finish</kbd>。</p>
<h5 id="生成子密钥"><a class="header" href="#生成子密钥">生成子密钥</a></h5>
<p>To Be Done（笔者不会）</p>
<h4 id="导出密钥"><a class="header" href="#导出密钥">导出密钥</a></h4>
<p>右键你想要导出的密钥，点击 <kbd>Backup secret keys</kbd> 即可。</p>
<h4 id="导入密钥"><a class="header" href="#导入密钥">导入密钥</a></h4>
<p>点击工具栏中的 <kbd>Import</kbd>，选择文件即可。</p>
<h4 id="文件加密"><a class="header" href="#文件加密">文件加密</a></h4>
<p>加密点击工具栏中的 <kbd>Sign/Encrypt</kbd>，选择文件，然后仅勾选 Encrypt，点击下一步即可。
解密点击工具栏中的 <kbd>Dncrypt/Verify</kbd>，选择文件，输入密码即可。</p>
<h4 id="签名与校验签名"><a class="header" href="#签名与校验签名">签名与校验签名</a></h4>
<p>同文件加密</p>
<h3 id="使用命令行工具"><a class="header" href="#使用命令行工具">使用命令行工具</a></h3>
<p>本节讲述如何使用 GPG 的命令行工具。</p>
<h4 id="生成密钥-1"><a class="header" href="#生成密钥-1">生成密钥</a></h4>
<p>在终端中输入 <code>gpg --full-generate-key</code> 来生成一对密钥，GPG 会逐个询问每个配置项。</p>
<p>首先会询问你想要的密钥类型：</p>
<pre><code>Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
  (14) Existing key from card
Your selection? 
</code></pre>
<p>关于各加密方式的实现和安全性，可以自行查阅资料，这里不再赘述。<br />
对于我们的一般需求选择默认的 <code>(1) RSA and RSA (default)</code> 就好。</p>
<p>接下来，GPG 会询问密钥长度：</p>
<pre><code>RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (3072) 
</code></pre>
<p>可选 1024 至 4096 的任意一个值，对 RSA 默认值为 3072，为了更好的更长久的安全性，这里推荐设置成 4096。</p>
<p>然后会询问你密钥的有效期限：</p>
<pre><code>Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0) 
</code></pre>
<p>默认是密钥永不过期，但是，<strong>极度不建议使用永不过期</strong>，这不是一个好的安全实践。</p>
<p>笔者推荐设置为两年，并设置日历提醒自己在有效期限临近的时候<a href="#%E8%AE%BE%E7%BD%AE%E6%9C%89%E6%95%88%E6%9C%9F%E9%99%90">重新设置有效期限</a>。</p>
<p>键入 <code>2y</code>，回车，<code>y</code>，然后再回车。</p>
<p>输入你的用户名和邮件地址还有注释（如果不想填可直接回车留空）。</p>
<p>然后设置密码。</p>
<p>最后得到的密钥如下：</p>
<pre><code>pub   rsa4096/39156228415722AD 2021-08-08 [SC] [expires: 2023-08-08]
uid                              Your Name (For intro to GPG) &lt;mail@example.org&gt;
sub   rsa4096/F0BB252EA3DF854B 2021-08-08 [E] [expires: 2023-08-08]
</code></pre>
<h5 id="生成子密钥-1"><a class="header" href="#生成子密钥-1">生成子密钥</a></h5>
<p>首先使用 <code>gpg --list-keys</code> 查看所有的 key，<code>rsa4096/</code> 后面的40位16进制数就是密钥的指纹（fingerprint）。</p>
<p>可以看到，GPG 在创建主密钥的过程中已经为我们创建了一个用于加密的子密钥。</p>
<p>然后，执行 <code>gpg --edit-key &lt;fingerprint&gt;</code>，注意将 <code>&lt;fingerprint&gt;</code> 换为你自己的密钥指纹，以下同理。</p>
<p>然后执行 <code>addkey</code>，根据用途自行选择，注意选 RSA 的。</p>
<p>最后执行 <code>save</code>。</p>
<h4 id="导出密钥-1"><a class="header" href="#导出密钥-1">导出密钥</a></h4>
<p>如果要导出公钥，执行</p>
<pre><code class="language-console">$ gpg --armor --output &lt;filename&gt; --export &lt;uid&gt;
</code></pre>
<p><code>&lt;filename&gt;</code> 是导出的文件的名称，<code>&lt;uid&gt;</code> 可以是你的姓名，邮箱，密钥指纹，只要能惟一确定密钥即可。注意如果导出子密钥的话，使用密钥指纹需要在后面加个感叹号。</p>
<p>如果要导出私钥，主密钥将 <code>--export</code> 替换为 <code>--export-secret-keys</code>，子密钥替换为 <code>--export-secret-subkeys</code> 即可。</p>
<p>如果要将密钥上传到公钥服务器，执行 <code>gpg --send-keys &lt;uid&gt; --keyserver &lt;keyserver url&gt;</code> 即可。</p>
<h4 id="导入密钥-1"><a class="header" href="#导入密钥-1">导入密钥</a></h4>
<p>公钥的话 <code>gpg --import &lt;filename&gt;</code> 即可，私钥用 <code>gpg --allow-secret-key-import --import &lt;filename&gt;</code>。</p>
<p>如果要从公钥服务器获取公钥，执行 <code>gpg --keyserver &lt;keyserver url&gt; --search-keys &lt;uid&gt;</code>。</p>
<p>如果对方使用了 WKD，那么执行 <code>gpg --locate-keys &lt;email&gt;</code> 即可</p>
<h4 id="文件加解密"><a class="header" href="#文件加解密">文件加解密</a></h4>
<p>加密：</p>
<pre><code class="language-console">$ gpg --recipient &lt;uid&gt; --output example.txt.gpg --encrypt example.txt
</code></pre>
<p>uid 意义同上文，将 <code>example.txt</code> 使用 uid 指定的密钥加密，保存到 <code>example.txt.gpg</code>。</p>
<p>解密：</p>
<pre><code class="language-console">$ gpg --output example.txt --decrypt example.txt.gpg
</code></pre>
<p>将 <code>example.txt.gpg</code> 解密，保存到 <code>example.txt</code>。</p>
<h4 id="签名与校验签名-1"><a class="header" href="#签名与校验签名-1">签名与校验签名</a></h4>
<p>对文件签名：</p>
<pre><code class="language-console">$ gpg --armor --detach-sign example.txt
</code></pre>
<p>会在同目录下生成一个 <code>example.txt.asc</code> 签名文件（纯 ASCII），如果不加 <code>--armor</code> 则生成的是二进制文件 <code>example.txt.sig</code></p>
<p>验证签名：
将文件和签名文件放在同一目录，然后执行：</p>
<pre><code class="language-console">$ gpg --verify example.txt.sig example.txt
</code></pre>
<p>签名消息:
执行 <code>gpg --clear-sign</code>，输入消息，然后 Ctrl+D 结束输入。</p>
<h4 id="为你的-git-commit-签名"><a class="header" href="#为你的-git-commit-签名">为你的 Git Commit 签名</a></h4>
<p>只需对 Git 进行如下配置即可：</p>
<pre><code class="language-console">$ git config --global user.signingkey &lt;uid&gt;
</code></pre>
<p>然后 commit 的时候加 <code>-S</code> 就可以签名了，如果想要每次 commit 都自动签名，执行：</p>
<pre><code class="language-console">$ git config --global commit.gpgsign true
</code></pre>
<p>在 GitHub 的设置里上传你的 GPG 公钥就能获得小绿勾啦。</p>
<h4 id="设置有效期限"><a class="header" href="#设置有效期限">设置有效期限</a></h4>
<p>执行 <code>gpg --edit-key &lt;fingerprint&gt;</code>，注意将 <code>&lt;fingerprint&gt;</code> 换为你自己的密钥指纹。</p>
<p>如果要修改子密钥的，需要先手动执行 <code>key &lt;fingerprint&gt;</code> 切换到对应 key.</p>
<p>然后执行 <code>expire</code>，选择期限，执行 <code>save</code>。</p>
<h4 id="生成吊销证书与吊销密钥"><a class="header" href="#生成吊销证书与吊销密钥">生成吊销证书与吊销密钥</a></h4>
<pre><code class="language-console">$ gpg --output master-key.rev --gen-revoke &lt;uid&gt;
</code></pre>
<p>注意只能导出主密钥的吊销证书。此外gpg默认已经为我们生成了一份吊销证书，位于 <code>$GPGHOME/openpgp-revocs.d/</code>。</p>
<p>如要吊销主密钥，执行 <code>gpg --import master-key.rev</code> 即可。</p>
<p>如要吊销子密钥，执行 <code>gpg --edit-key &lt;fingerprint&gt;</code>，然后执行 <code>key &lt;fingerprint&gt;</code> 切换到对应 key，执行 <code>revkey</code>。</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../security/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../security/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
